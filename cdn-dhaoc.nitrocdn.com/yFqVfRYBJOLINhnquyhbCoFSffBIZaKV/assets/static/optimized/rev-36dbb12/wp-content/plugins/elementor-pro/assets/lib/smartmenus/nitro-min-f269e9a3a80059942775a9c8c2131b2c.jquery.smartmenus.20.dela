(function(t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=t(require("jquery"))}else{t(jQuery)}})(function($){var menuTrees=[],IE=!!window.createPopup,mouse=false,touchEvents="ontouchstart"in window,mouseDetectionEnabled=false,requestAnimationFrame=window.requestAnimationFrame||function(t){return setTimeout(t,1e3/60)},cancelAnimationFrame=window.cancelAnimationFrame||function(t){clearTimeout(t)};function initMouseDetection(t){var e=".smartmenus_mouse";if(!mouseDetectionEnabled&&!t){var a=true,r=null;$(document).bind(getEventsNS([["mousemove",function(t){var e={x:t.pageX,y:t.pageY,timeStamp:(new Date).getTime()};if(r){var i=Math.abs(r.x-e.x),s=Math.abs(r.y-e.y);if((i>0||s>0)&&i<=2&&s<=2&&e.timeStamp-r.timeStamp<=300){mouse=true;if(a){var o=$(t.target).closest("a");if(o.is("a")){$.each(menuTrees,function(){if($.contains(this.$root[0],o[0])){this.itemEnter({currentTarget:o[0]});return false}})}a=false}}}r=e}],[touchEvents?"touchstart":"pointerover pointermove pointerout MSPointerOver MSPointerMove MSPointerOut",function(t){if(isTouchEvent(t.originalEvent)){mouse=false}}]],e));mouseDetectionEnabled=true}else if(mouseDetectionEnabled&&t){$(document).unbind(e);mouseDetectionEnabled=false}}function isTouchEvent(t){return!/^(4|mouse)$/.test(t.pointerType)}function getEventsNS(t,i){if(!i){i=""}var s={};$.each(t,function(t,e){s[e[0].split(" ").join(i+" ")+i]=e[1]});return s}$.SmartMenus=function(t,e){this.$root=$(t);this.opts=e;this.rootId="";this.accessIdPrefix="";this.$subArrow=null;this.activatedItems=[];this.visibleSubMenus=[];this.showTimeout=0;this.hideTimeout=0;this.scrollTimeout=0;this.clickActivated=false;this.focusActivated=false;this.zIndexInc=0;this.idInc=0;this.$firstLink=null;this.$firstSub=null;this.disabled=false;this.$disableOverlay=null;this.$touchScrollingSub=null;this.cssTransforms3d="perspective"in t.style||"webkitPerspective"in t.style;this.wasCollapsible=false;this.init()};$.extend($.SmartMenus,{hideAll:function(){$.each(menuTrees,function(){this.menuHideAll()})},destroy:function(){while(menuTrees.length){menuTrees[0].destroy()}initMouseDetection(true)},prototype:{init:function(t){var i=this;if(!t){menuTrees.push(this);this.rootId=((new Date).getTime()+Math.random()+"").replace(/\D/g,"");this.accessIdPrefix="sm-"+this.rootId+"-";if(this.$root.hasClass("sm-rtl")){this.opts.rightToLeftSubMenus=true}var e=".smartmenus";this.$root.data("smartmenus",this).attr("data-smartmenus-id",this.rootId).dataSM("level",1).bind(getEventsNS([["mouseover focusin",$.proxy(this.rootOver,this)],["mouseout focusout",$.proxy(this.rootOut,this)],["keydown",$.proxy(this.rootKeyDown,this)]],e)).delegate("a",getEventsNS([["mouseenter",$.proxy(this.itemEnter,this)],["mouseleave",$.proxy(this.itemLeave,this)],["mousedown",$.proxy(this.itemDown,this)],["focus",$.proxy(this.itemFocus,this)],["blur",$.proxy(this.itemBlur,this)],["click",$.proxy(this.itemClick,this)]],e));e+=this.rootId;if(this.opts.hideOnClick){$(document).bind(getEventsNS([["touchstart",$.proxy(this.docTouchStart,this)],["touchmove",$.proxy(this.docTouchMove,this)],["touchend",$.proxy(this.docTouchEnd,this)],["click",$.proxy(this.docClick,this)]],e))}$(window).bind(getEventsNS([["resize orientationchange",$.proxy(this.winResize,this)]],e));if(this.opts.subIndicators){this.$subArrow=$("<span/>").addClass("sub-arrow");if(this.opts.subIndicatorsText){this.$subArrow.html(this.opts.subIndicatorsText)}}initMouseDetection()}this.$firstSub=this.$root.find("ul").each(function(){i.menuInit($(this))}).eq(0);this.$firstLink=this.$root.find("a").eq(0);if(this.opts.markCurrentItem){var s=/(index|default)\.[^#\?\/]*/i,o=/#.*/,a=window.location.href.replace(s,""),r=a.replace(o,"");this.$root.find("a").each(function(){var t=this.href.replace(s,""),e=$(this);if(t==a||t==r){e.addClass("current");if(i.opts.markCurrentTree){e.parentsUntil("[data-smartmenus-id]","ul").each(function(){$(this).dataSM("parent-a").addClass("current")})}}})}this.wasCollapsible=this.isCollapsible()},destroy:function(t){if(!t){var e=".smartmenus";this.$root.removeData("smartmenus").removeAttr("data-smartmenus-id").removeDataSM("level").unbind(e).undelegate(e);e+=this.rootId;$(document).unbind(e);$(window).unbind(e);if(this.opts.subIndicators){this.$subArrow=null}}this.menuHideAll();var i=this;this.$root.find("ul").each(function(){var t=$(this);if(t.dataSM("scroll-arrows")){t.dataSM("scroll-arrows").remove()}if(t.dataSM("shown-before")){if(i.opts.subMenusMinWidth||i.opts.subMenusMaxWidth){t.css({width:"",minWidth:"",maxWidth:""}).removeClass("sm-nowrap")}if(t.dataSM("scroll-arrows")){t.dataSM("scroll-arrows").remove()}t.css({zIndex:"",top:"",left:"",marginLeft:"",marginTop:"",display:""})}if((t.attr("id")||"").indexOf(i.accessIdPrefix)==0){t.removeAttr("id")}}).removeDataSM("in-mega").removeDataSM("shown-before").removeDataSM("ie-shim").removeDataSM("scroll-arrows").removeDataSM("parent-a").removeDataSM("level").removeDataSM("beforefirstshowfired").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeAttr("aria-expanded");this.$root.find("a.has-submenu").each(function(){var t=$(this);if(t.attr("id").indexOf(i.accessIdPrefix)==0){t.removeAttr("id")}}).removeClass("has-submenu").removeDataSM("sub").removeAttr("aria-haspopup").removeAttr("aria-controls").removeAttr("aria-expanded").closest("li").removeDataSM("sub");if(this.opts.subIndicators){this.$root.find("span.sub-arrow").remove()}if(this.opts.markCurrentItem){this.$root.find("a.current").removeClass("current")}if(!t){this.$root=null;this.$firstLink=null;this.$firstSub=null;if(this.$disableOverlay){this.$disableOverlay.remove();this.$disableOverlay=null}menuTrees.splice($.inArray(this,menuTrees),1)}},disable:function(t){if(!this.disabled){this.menuHideAll();if(!t&&!this.opts.isPopup&&this.$root.is(":visible")){var e=this.$root.offset();this.$disableOverlay=$('<div class="sm-jquery-disable-overlay"/>').css({position:"absolute",top:e.top,left:e.left,width:this.$root.outerWidth(),height:this.$root.outerHeight(),zIndex:this.getStartZIndex(true),opacity:0}).appendTo(document.body)}this.disabled=true}},docClick:function(t){if(this.$touchScrollingSub){this.$touchScrollingSub=null;return}if(this.visibleSubMenus.length&&!$.contains(this.$root[0],t.target)||$(t.target).is("a")){this.menuHideAll()}},docTouchEnd:function(t){if(!this.lastTouch){return}if(this.visibleSubMenus.length&&(this.lastTouch.x2===undefined||this.lastTouch.x1==this.lastTouch.x2)&&(this.lastTouch.y2===undefined||this.lastTouch.y1==this.lastTouch.y2)&&(!this.lastTouch.target||!$.contains(this.$root[0],this.lastTouch.target))){if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=0}var e=this;this.hideTimeout=setTimeout(function(){e.menuHideAll()},350)}this.lastTouch=null},docTouchMove:function(t){if(!this.lastTouch){return}var e=t.originalEvent.touches[0];this.lastTouch.x2=e.pageX;this.lastTouch.y2=e.pageY},docTouchStart:function(t){var e=t.originalEvent.touches[0];this.lastTouch={x1:e.pageX,y1:e.pageY,target:e.target}},enable:function(){if(this.disabled){if(this.$disableOverlay){this.$disableOverlay.remove();this.$disableOverlay=null}this.disabled=false}},getClosestMenu:function(t){var e=$(t).closest("ul");while(e.dataSM("in-mega")){e=e.parent().closest("ul")}return e[0]||null},getHeight:function(t){return this.getOffset(t,true)},getOffset:function(t,e){var i;if(t.css("display")=="none"){i={position:t[0].style.position,visibility:t[0].style.visibility};t.css({position:"absolute",visibility:"hidden"}).show()}var s=t[0].getBoundingClientRect&&t[0].getBoundingClientRect(),o=s&&(e?s.height||s.bottom-s.top:s.width||s.right-s.left);if(!o&&o!==0){o=e?t[0].offsetHeight:t[0].offsetWidth}if(i){t.hide().css(i)}return o},getStartZIndex:function(t){var e=parseInt(this[t?"$root":"$firstSub"].css("z-index"));if(!t&&isNaN(e)){e=parseInt(this.$root.css("z-index"))}return!isNaN(e)?e:1},getTouchPoint:function(t){return t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0]||t},getViewport:function(t){var e=t?"Height":"Width",i=document.documentElement["client"+e],s=window["inner"+e];if(s){i=Math.min(i,s)}return i},getViewportHeight:function(){return this.getViewport(true)},getViewportWidth:function(){return this.getViewport()},getWidth:function(t){return this.getOffset(t)},handleEvents:function(){return!this.disabled&&this.isCSSOn()},handleItemEvents:function(t){return this.handleEvents()&&!this.isLinkInMegaMenu(t)},isCollapsible:function(){return this.$firstSub.css("position")=="static"},isCSSOn:function(){return this.$firstLink.css("display")=="block"},isFixed:function(){var t=this.$root.css("position")=="fixed";if(!t){this.$root.parentsUntil("body").each(function(){if($(this).css("position")=="fixed"){t=true;return false}})}return t},isLinkInMegaMenu:function(t){return $(this.getClosestMenu(t[0])).hasClass("mega-menu")},isTouchMode:function(){return!mouse||this.opts.noMouseOver||this.isCollapsible()},itemActivate:function(t,e){var i=t.closest("ul"),s=i.dataSM("level");if(s>1&&(!this.activatedItems[s-2]||this.activatedItems[s-2][0]!=i.dataSM("parent-a")[0])){var o=this;$(i.parentsUntil("[data-smartmenus-id]","ul").get().reverse()).add(i).each(function(){o.itemActivate($(this).dataSM("parent-a"))})}if(!this.isCollapsible()||e){this.menuHideSubMenus(!this.activatedItems[s-1]||this.activatedItems[s-1][0]!=t[0]?s-1:s)}this.activatedItems[s-1]=t;if(this.$root.triggerHandler("activate.smapi",t[0])===false){return}var a=t.dataSM("sub");if(a&&(this.isTouchMode()||(!this.opts.showOnClick||this.clickActivated))){this.menuShow(a)}},itemBlur:function(t){var e=$(t.currentTarget);if(!this.handleItemEvents(e)){return}this.$root.triggerHandler("blur.smapi",e[0])},itemClick:function(t){var e=$(t.currentTarget);if(!this.handleItemEvents(e)){return}if(this.$touchScrollingSub&&this.$touchScrollingSub[0]==e.closest("ul")[0]){this.$touchScrollingSub=null;t.stopPropagation();return false}if(this.$root.triggerHandler("click.smapi",e[0])===false){return false}var i=$(t.target).is("span.sub-arrow"),s=e.dataSM("sub"),o=s?s.dataSM("level")==2:false;if(s&&!s.is(":visible")){if(this.opts.showOnClick&&o){this.clickActivated=true}this.itemActivate(e);if(s.is(":visible")){this.focusActivated=true;return false}}else if(this.isCollapsible()&&i){this.itemActivate(e);this.menuHide(s);return false}if(this.opts.showOnClick&&o||e.hasClass("disabled")||this.$root.triggerHandler("select.smapi",e[0])===false){return false}},itemDown:function(t){var e=$(t.currentTarget);if(!this.handleItemEvents(e)){return}e.dataSM("mousedown",true)},itemEnter:function(t){var e=$(t.currentTarget);if(!this.handleItemEvents(e)){return}if(!this.isTouchMode()){if(this.showTimeout){clearTimeout(this.showTimeout);this.showTimeout=0}var i=this;this.showTimeout=setTimeout(function(){i.itemActivate(e)},this.opts.showOnClick&&e.closest("ul").dataSM("level")==1?1:this.opts.showTimeout)}this.$root.triggerHandler("mouseenter.smapi",e[0])},itemFocus:function(t){var e=$(t.currentTarget);if(!this.handleItemEvents(e)){return}if(this.focusActivated&&(!this.isTouchMode()||!e.dataSM("mousedown"))&&(!this.activatedItems.length||this.activatedItems[this.activatedItems.length-1][0]!=e[0])){this.itemActivate(e,true)}this.$root.triggerHandler("focus.smapi",e[0])},itemLeave:function(t){var e=$(t.currentTarget);if(!this.handleItemEvents(e)){return}if(!this.isTouchMode()){e[0].blur();if(this.showTimeout){clearTimeout(this.showTimeout);this.showTimeout=0}}e.removeDataSM("mousedown");this.$root.triggerHandler("mouseleave.smapi",e[0])},menuHide:function(t){if(this.$root.triggerHandler("beforehide.smapi",t[0])===false){return}t.stop(true,true);if(t.css("display")!="none"){var e=function(){t.css("z-index","")};if(this.isCollapsible()){if(this.opts.collapsibleHideFunction){this.opts.collapsibleHideFunction.call(this,t,e)}else{t.hide(this.opts.collapsibleHideDuration,e)}}else{if(this.opts.hideFunction){this.opts.hideFunction.call(this,t,e)}else{t.hide(this.opts.hideDuration,e)}}if(t.dataSM("ie-shim")){t.dataSM("ie-shim").remove().css({"-webkit-transform":"",transform:""})}if(t.dataSM("scroll")){this.menuScrollStop(t);t.css({"touch-action":"","-ms-touch-action":"","-webkit-transform":"",transform:""}).unbind(".smartmenus_scroll").removeDataSM("scroll").dataSM("scroll-arrows").hide()}t.dataSM("parent-a").removeClass("highlighted").attr("aria-expanded","false");t.attr({"aria-expanded":"false","aria-hidden":"true"});var i=t.dataSM("level");this.activatedItems.splice(i-1,1);this.visibleSubMenus.splice($.inArray(t,this.visibleSubMenus),1);this.$root.triggerHandler("hide.smapi",t[0])}},menuHideAll:function(){if(this.showTimeout){clearTimeout(this.showTimeout);this.showTimeout=0}var t=this.opts.isPopup?1:0;for(var e=this.visibleSubMenus.length-1;e>=t;e--){this.menuHide(this.visibleSubMenus[e])}if(this.opts.isPopup){this.$root.stop(true,true);if(this.$root.is(":visible")){if(this.opts.hideFunction){this.opts.hideFunction.call(this,this.$root)}else{this.$root.hide(this.opts.hideDuration)}if(this.$root.dataSM("ie-shim")){this.$root.dataSM("ie-shim").remove()}}}this.activatedItems=[];this.visibleSubMenus=[];this.clickActivated=false;this.focusActivated=false;this.zIndexInc=0;this.$root.triggerHandler("hideAll.smapi")},menuHideSubMenus:function(t){for(var e=this.activatedItems.length-1;e>=t;e--){var i=this.activatedItems[e].dataSM("sub");if(i){this.menuHide(i)}}},menuIframeShim:function(t){if(IE&&this.opts.overlapControlsInIE&&!t.dataSM("ie-shim")){t.dataSM("ie-shim",$("<iframe/>").attr({src:"javascript:0",tabindex:-9}).css({position:"absolute",top:"auto",left:"0",opacity:0,border:"0"}))}},menuInit:function(t){if(!t.dataSM("in-mega")){if(t.hasClass("mega-menu")){t.find("ul").dataSM("in-mega",true)}var e=2,i=t[0];while((i=i.parentNode.parentNode)!=this.$root[0]){e++}var s=t.prevAll("a").eq(-1);if(!s.length){s=t.prevAll().find("a").eq(-1)}s.addClass("has-submenu").dataSM("sub",t);t.dataSM("parent-a",s).dataSM("level",e).parent().dataSM("sub",t);var o=s.attr("id")||this.accessIdPrefix+ ++this.idInc,a=t.attr("id")||this.accessIdPrefix+ ++this.idInc;s.attr({id:o,"aria-haspopup":"true","aria-controls":a,"aria-expanded":"false"});t.attr({id:a,role:"group","aria-hidden":"true","aria-labelledby":o,"aria-expanded":"false"});if(this.opts.subIndicators){s[this.opts.subIndicatorsPos](this.$subArrow.clone())}}},menuPosition:function(e){var t=e.dataSM("parent-a"),i=t.closest("li"),s=i.parent(),o=e.dataSM("level"),a=this.getWidth(e),r=this.getHeight(e),n=t.offset(),h=n.left,u=n.top,l=this.getWidth(t),c=this.getHeight(t),d=$(window),f=d.scrollLeft(),m=d.scrollTop(),p=this.getViewportWidth(),v=this.getViewportHeight(),b=s.parent().is("[data-sm-horizontal-sub]")||o==2&&!s.hasClass("sm-vertical"),S=this.opts.rightToLeftSubMenus&&!i.is("[data-sm-reverse]")||!this.opts.rightToLeftSubMenus&&i.is("[data-sm-reverse]"),g=o==2?this.opts.mainMenuSubOffsetX:this.opts.subMenusSubOffsetX,M=o==2?this.opts.mainMenuSubOffsetY:this.opts.subMenusSubOffsetY,w,T;if(b){w=S?l-a-g:g;T=this.opts.bottomToTopSubMenus?-r-M:c+M}else{w=S?g-a:l-g;T=this.opts.bottomToTopSubMenus?c-M-r:M}if(this.opts.keepInViewport){var y=h+w,I=u+T;if(S&&y<f){w=b?f-y+w:l-g}else if(!S&&y+a>f+p){w=b?f+p-a-y+w:g-a}if(!b){if(r<v&&I+r>m+v){T+=m+v-r-I}else if(r>=v||I<m){T+=m-I}}if(b&&(I+r>m+v+.49||I<m)||!b&&r>v+.49){var x=this;if(!e.dataSM("scroll-arrows")){e.dataSM("scroll-arrows",$([$('<span class="scroll-up"><span class="scroll-up-arrow"></span></span>')[0],$('<span class="scroll-down"><span class="scroll-down-arrow"></span></span>')[0]]).bind({mouseenter:function(){e.dataSM("scroll").up=$(this).hasClass("scroll-up");x.menuScroll(e)},mouseleave:function(t){x.menuScrollStop(e);x.menuScrollOut(e,t)},"mousewheel DOMMouseScroll":function(t){t.preventDefault()}}).insertAfter(e))}var C=".smartmenus_scroll";e.dataSM("scroll",{y:this.cssTransforms3d?0:T-c,step:1,itemH:c,subH:r,arrowDownH:this.getHeight(e.dataSM("scroll-arrows").eq(1))}).bind(getEventsNS([["mouseover",function(t){x.menuScrollOver(e,t)}],["mouseout",function(t){x.menuScrollOut(e,t)}],["mousewheel DOMMouseScroll",function(t){x.menuScrollMousewheel(e,t)}]],C)).dataSM("scroll-arrows").css({top:"auto",left:"0",marginLeft:w+(parseInt(e.css("border-left-width"))||0),width:a-(parseInt(e.css("border-left-width"))||0)-(parseInt(e.css("border-right-width"))||0),zIndex:e.css("z-index")}).eq(b&&this.opts.bottomToTopSubMenus?0:1).show();if(this.isFixed()){e.css({"touch-action":"none","-ms-touch-action":"none"}).bind(getEventsNS([[touchEvents?"touchstart touchmove touchend":"pointerdown pointermove pointerup MSPointerDown MSPointerMove MSPointerUp",function(t){x.menuScrollTouch(e,t)}]],C))}}}e.css({top:"auto",left:"0",marginLeft:w,marginTop:T-c});this.menuIframeShim(e);if(e.dataSM("ie-shim")){e.dataSM("ie-shim").css({zIndex:e.css("z-index"),width:a,height:r,marginLeft:w,marginTop:T-c})}},menuScroll:function(t,e,i){var s=t.dataSM("scroll"),o=t.dataSM("scroll-arrows"),a=s.up?s.upEnd:s.downEnd,r;if(!e&&s.momentum){s.momentum*=.92;r=s.momentum;if(r<.5){this.menuScrollStop(t);return}}else{r=i||(e||!this.opts.scrollAccelerate?this.opts.scrollStep:Math.floor(s.step))}var n=t.dataSM("level");if(this.activatedItems[n-1]&&this.activatedItems[n-1].dataSM("sub")&&this.activatedItems[n-1].dataSM("sub").is(":visible")){this.menuHideSubMenus(n-1)}s.y=s.up&&a<=s.y||!s.up&&a>=s.y?s.y:Math.abs(a-s.y)>r?s.y+(s.up?r:-r):a;t.add(t.dataSM("ie-shim")).css(this.cssTransforms3d?{"-webkit-transform":"translate3d(0, "+s.y+"px, 0)",transform:"translate3d(0, "+s.y+"px, 0)"}:{marginTop:s.y});if(mouse&&(s.up&&s.y>s.downEnd||!s.up&&s.y<s.upEnd)){o.eq(s.up?1:0).show()}if(s.y==a){if(mouse){o.eq(s.up?0:1).hide()}this.menuScrollStop(t)}else if(!e){if(this.opts.scrollAccelerate&&s.step<this.opts.scrollStep){s.step+=.2}var h=this;this.scrollTimeout=requestAnimationFrame(function(){h.menuScroll(t)})}},menuScrollMousewheel:function(t,e){if(this.getClosestMenu(e.target)==t[0]){e=e.originalEvent;var i=(e.wheelDelta||-e.detail)>0;if(t.dataSM("scroll-arrows").eq(i?0:1).is(":visible")){t.dataSM("scroll").up=i;this.menuScroll(t,true)}}e.preventDefault()},menuScrollOut:function(t,e){if(mouse){if(!/^scroll-(up|down)/.test((e.relatedTarget||"").className)&&(t[0]!=e.relatedTarget&&!$.contains(t[0],e.relatedTarget)||this.getClosestMenu(e.relatedTarget)!=t[0])){t.dataSM("scroll-arrows").css("visibility","hidden")}}},menuScrollOver:function(t,e){if(mouse){if(!/^scroll-(up|down)/.test(e.target.className)&&this.getClosestMenu(e.target)==t[0]){this.menuScrollRefreshData(t);var i=t.dataSM("scroll"),s=$(window).scrollTop()-t.dataSM("parent-a").offset().top-i.itemH;t.dataSM("scroll-arrows").eq(0).css("margin-top",s).end().eq(1).css("margin-top",s+this.getViewportHeight()-i.arrowDownH).end().css("visibility","visible")}}},menuScrollRefreshData:function(t){var e=t.dataSM("scroll"),i=$(window).scrollTop()-t.dataSM("parent-a").offset().top-e.itemH;if(this.cssTransforms3d){i=-(parseFloat(t.css("margin-top"))-i)}$.extend(e,{upEnd:i,downEnd:i+this.getViewportHeight()-e.subH})},menuScrollStop:function(t){if(this.scrollTimeout){cancelAnimationFrame(this.scrollTimeout);this.scrollTimeout=0;t.dataSM("scroll").step=1;return true}},menuScrollTouch:function(t,e){e=e.originalEvent;if(isTouchEvent(e)){var i=this.getTouchPoint(e);if(this.getClosestMenu(i.target)==t[0]){var s=t.dataSM("scroll");if(/(start|down)$/i.test(e.type)){if(this.menuScrollStop(t)){e.preventDefault();this.$touchScrollingSub=t}else{this.$touchScrollingSub=null}this.menuScrollRefreshData(t);$.extend(s,{touchStartY:i.pageY,touchStartTime:e.timeStamp})}else if(/move$/i.test(e.type)){var o=s.touchY!==undefined?s.touchY:s.touchStartY;if(o!==undefined&&o!=i.pageY){this.$touchScrollingSub=t;var a=o<i.pageY;if(s.up!==undefined&&s.up!=a){$.extend(s,{touchStartY:i.pageY,touchStartTime:e.timeStamp})}$.extend(s,{up:a,touchY:i.pageY});this.menuScroll(t,true,Math.abs(i.pageY-o))}e.preventDefault()}else{if(s.touchY!==undefined){if(s.momentum=Math.pow(Math.abs(i.pageY-s.touchStartY)/(e.timeStamp-s.touchStartTime),2)*15){this.menuScrollStop(t);this.menuScroll(t);e.preventDefault()}delete s.touchY}}}}},menuShow:function(t){if(!t.dataSM("beforefirstshowfired")){t.dataSM("beforefirstshowfired",true);if(this.$root.triggerHandler("beforefirstshow.smapi",t[0])===false){return}}if(this.$root.triggerHandler("beforeshow.smapi",t[0])===false){return}t.dataSM("shown-before",true).stop(true,true);if(!t.is(":visible")){var e=t.dataSM("parent-a");if(this.opts.keepHighlighted||this.isCollapsible()){e.addClass("highlighted")}if(this.isCollapsible()){t.removeClass("sm-nowrap").css({zIndex:"",width:"auto",minWidth:"",maxWidth:"",top:"",left:"",marginLeft:"",marginTop:""})}else{t.css("z-index",this.zIndexInc=(this.zIndexInc||this.getStartZIndex())+1);if(this.opts.subMenusMinWidth||this.opts.subMenusMaxWidth){t.css({width:"auto",minWidth:"",maxWidth:""}).addClass("sm-nowrap");if(this.opts.subMenusMinWidth){t.css("min-width",this.opts.subMenusMinWidth)}if(this.opts.subMenusMaxWidth){var i=this.getWidth(t);t.css("max-width",this.opts.subMenusMaxWidth);if(i>this.getWidth(t)){t.removeClass("sm-nowrap").css("width",this.opts.subMenusMaxWidth)}}}this.menuPosition(t);if(t.dataSM("ie-shim")){t.dataSM("ie-shim").insertBefore(t)}}var s=function(){t.css("overflow","")};if(this.isCollapsible()){if(this.opts.collapsibleShowFunction){this.opts.collapsibleShowFunction.call(this,t,s)}else{t.show(this.opts.collapsibleShowDuration,s)}}else{if(this.opts.showFunction){this.opts.showFunction.call(this,t,s)}else{t.show(this.opts.showDuration,s)}}e.attr("aria-expanded","true");t.attr({"aria-expanded":"true","aria-hidden":"false"});this.visibleSubMenus.push(t);this.$root.triggerHandler("show.smapi",t[0])}},popupHide:function(t){if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=0}var e=this;this.hideTimeout=setTimeout(function(){e.menuHideAll()},t?1:this.opts.hideTimeout)},popupShow:function(t,e){if(!this.opts.isPopup){alert('SmartMenus jQuery Error:\n\nIf you want to show this menu via the "popupShow" method, set the isPopup:true option.');return}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=0}this.$root.dataSM("shown-before",true).stop(true,true);if(!this.$root.is(":visible")){this.$root.css({left:t,top:e});this.menuIframeShim(this.$root);if(this.$root.dataSM("ie-shim")){this.$root.dataSM("ie-shim").css({zIndex:this.$root.css("z-index"),width:this.getWidth(this.$root),height:this.getHeight(this.$root),left:t,top:e}).insertBefore(this.$root)}var i=this,s=function(){i.$root.css("overflow","")};if(this.opts.showFunction){this.opts.showFunction.call(this,this.$root,s)}else{this.$root.show(this.opts.showDuration,s)}this.visibleSubMenus[0]=this.$root}},refresh:function(){this.destroy(true);this.init(true)},rootKeyDown:function(t){if(!this.handleEvents()){return}switch(t.keyCode){case 27:var e=this.activatedItems[0];if(e){this.menuHideAll();e[0].focus();var i=e.dataSM("sub");if(i){this.menuHide(i)}}break;case 32:var s=$(t.target);if(s.is("a")&&this.handleItemEvents(s)){var i=s.dataSM("sub");if(i&&!i.is(":visible")){this.itemClick({currentTarget:t.target});t.preventDefault()}}break}},rootOut:function(t){if(!this.handleEvents()||this.isTouchMode()||t.target==this.$root[0]){return}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=0}if(!this.opts.showOnClick||!this.opts.hideOnClick){var e=this;this.hideTimeout=setTimeout(function(){e.menuHideAll()},this.opts.hideTimeout)}},rootOver:function(t){if(!this.handleEvents()||this.isTouchMode()||t.target==this.$root[0]){return}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=0}},winResize:function(t){if(!this.handleEvents()){if(this.$disableOverlay){var e=this.$root.offset();this.$disableOverlay.css({top:e.top,left:e.left,width:this.$root.outerWidth(),height:this.$root.outerHeight()})}return}if(!("onorientationchange"in window)||t.type=="orientationchange"){var i=this.isCollapsible();if(!(this.wasCollapsible&&i)){if(this.activatedItems.length){this.activatedItems[this.activatedItems.length-1][0].blur()}this.menuHideAll()}this.wasCollapsible=i}}}});$.fn.dataSM=function(t,e){if(e){return this.data(t+"_smartmenus",e)}return this.data(t+"_smartmenus")};$.fn.removeDataSM=function(t){return this.removeData(t+"_smartmenus")};$.fn.smartmenus=function(options){if(typeof options=="string"){var args=arguments,method=options;Array.prototype.shift.call(args);return this.each(function(){var t=$(this).data("smartmenus");if(t&&t[method]){t[method].apply(t,args)}})}var dataOpts=this.data("sm-options")||null;if(dataOpts){try{dataOpts=eval("("+dataOpts+")")}catch(e){dataOpts=null;alert('ERROR\n\nSmartMenus jQuery init:\nInvalid "data-sm-options" attribute value syntax.')}}return this.each(function(){new $.SmartMenus(this,$.extend({},$.fn.smartmenus.defaults,options,dataOpts))})};$.fn.smartmenus.defaults={isPopup:false,mainMenuSubOffsetX:0,mainMenuSubOffsetY:0,subMenusSubOffsetX:0,subMenusSubOffsetY:0,subMenusMinWidth:"10em",subMenusMaxWidth:"20em",subIndicators:true,subIndicatorsPos:"prepend",subIndicatorsText:"+",scrollStep:30,scrollAccelerate:true,showTimeout:250,hideTimeout:500,showDuration:0,showFunction:null,hideDuration:0,hideFunction:function(t,e){t.fadeOut(200,e)},collapsibleShowDuration:0,collapsibleShowFunction:function(t,e){t.slideDown(200,e)},collapsibleHideDuration:0,collapsibleHideFunction:function(t,e){t.slideUp(200,e)},showOnClick:false,hideOnClick:true,noMouseOver:false,keepInViewport:true,keepHighlighted:true,markCurrentItem:false,markCurrentTree:true,rightToLeftSubMenus:false,bottomToTopSubMenus:false,overlapControlsInIE:true};return $});