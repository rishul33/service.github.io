(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){e(require("jquery"))}else{e(jQuery)}})(function(S){var e=navigator.userAgent,T=/iphone/i.test(e),E=/chrome/i.test(e),C=/android/i.test(e),D;S.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:true,dataName:"rawMaskFn",placeholder:"_"};S.fn.extend({caret:function(e,t){var n;if(this.length===0||this.is(":hidden")||this.get(0)!==document.activeElement){return}if(typeof e=="number"){t=typeof t==="number"?t:e;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(e,t)}else if(this.createTextRange){n=this.createTextRange();n.collapse(true);n.moveEnd("character",t);n.moveStart("character",e);n.select()}})}else{if(this[0].setSelectionRange){e=this[0].selectionStart;t=this[0].selectionEnd}else if(document.selection&&document.selection.createRange){n=document.selection.createRange();e=0-n.duplicate().moveStart("character",-1e5);t=e+n.text.length}return{begin:e,end:t}}},unmask:function(){return this.trigger("unmask")},mask:function(i,k){var e,a,y,w,x,j,A,R;if(!i&&this.length>0){e=S(this[0]);var t=e.data(S.mask.dataName);return t?t():undefined}k=S.extend({autoclear:S.mask.autoclear,placeholder:S.mask.placeholder,completed:null},k);a=S.mask.definitions;y=[];w=A=i.length;x=null;i=String(i);S.each(i.split(""),function(e,t){if(t=="?"){A--;w=e}else if(a[t]){y.push(new RegExp(a[t]));if(x===null){x=y.length-1}if(e<w){j=y.length-1}}else{y.push(null)}});return this.trigger("unmask").each(function(){var o=S(this),l=S.map(i.split(""),function(e,t){if(e!="?"){return a[e]?u(t):e}}),f=l.join(""),r=o.val();function c(){if(!k.completed){return}for(var e=x;e<=j;e++){if(y[e]&&l[e]===u(e)){return}}k.completed.call(o)}function u(e){if(e<k.placeholder.length)return k.placeholder.charAt(e);return k.placeholder.charAt(0)}function s(e){while(++e<A&&!y[e]);return e}function h(e){while(--e>=0&&!y[e]);return e}function g(e,t){var n,i;if(e<0){return}for(n=e,i=s(t);n<A;n++){if(y[n]){if(i<A&&y[n].test(l[i])){l[n]=l[i];l[i]=u(i)}else{break}i=s(i)}}v();o.caret(Math.max(x,e))}function m(e){var t,n,i,a;for(t=e,n=u(e);t<A;t++){if(y[t]){i=s(t);a=l[t];l[t]=n;if(i<A&&y[i].test(a)){n=a}else{break}}}}function e(e){var t=o.val();var n=o.caret();var i=function(){S.proxy(S.fn.caret,o,n.begin,n.begin)()};if(R&&R.length&&R.length>t.length){b(true);while(n.begin>0&&!y[n.begin-1])n.begin--;if(n.begin===0){while(n.begin<x&&!y[n.begin])n.begin++}setTimeout(i,0)}else{var a=b(true);var r=t.charAt(n.begin);if(n.begin<A){if(!y[n.begin]){n.begin=a}else{if(y[n.begin].test(r)){n.begin++}}}setTimeout(i,0)}c()}function d(e){b();if(o.val()!=r)o.change()}function t(e){if(o.prop("readonly")){return}var t=e.which||e.keyCode,n,i,a;R=o.val();if(t===8||t===46||T&&t===127){n=o.caret();i=n.begin;a=n.end;if(a-i===0){i=t!==46?h(i):a=s(i-1);a=t===46?s(a):a}p(i,a);g(i,a-1);e.preventDefault()}else if(t===13){d.call(this,e)}else if(t===27){o.val(r);o.caret(0,b());e.preventDefault()}}function n(e){if(o.prop("readonly")){return}var t=e.which||e.keyCode,n=o.caret(),i,a,r;if(e.ctrlKey||e.altKey||e.metaKey||t<32){return}else if(t&&t!==13){if(n.end-n.begin!==0){p(n.begin,n.end);g(n.begin,n.end-1)}i=s(n.begin-1);if(i<A){a=String.fromCharCode(t);if(y[i].test(a)){m(i);l[i]=a;v();r=s(i);if(C){var f=function(){S.proxy(S.fn.caret,o,r)()};setTimeout(f,0)}else{o.caret(r)}if(n.begin<=j){c()}}}e.preventDefault()}}function p(e,t){var n;for(n=e;n<t&&n<A;n++){if(y[n]){l[n]=u(n)}}}function v(){o.val(l.join(""))}function b(e){var t=o.val(),n=-1,i,a,r;for(i=0,r=0;i<A;i++){if(y[i]){l[i]=u(i);while(r++<t.length){a=t.charAt(r-1);if(y[i].test(a)){l[i]=a;n=i;break}}if(r>t.length){p(i+1,A);break}}else{if(l[i]===t.charAt(r)){r++}if(i<w){n=i}}}if(e){v()}else if(n+1<w){if(k.autoclear||l.join("")===f){if(o.val())o.val("");p(0,A)}else{v()}}else{v();o.val(o.val().substring(0,n+1))}return w?i:x}o.data(S.mask.dataName,function(){return S.map(l,function(e,t){return y[t]&&e!=u(t)?e:null}).join("")});o.one("unmask",function(){o.off(".mask").removeData(S.mask.dataName)}).on("focus.mask",function(){if(o.prop("readonly")){return}clearTimeout(D);var e;r=o.val();e=b();D=setTimeout(function(){if(o.get(0)!==document.activeElement){return}v();if(e==i.replace("?","").length){o.caret(0,e)}else{o.caret(e)}},10)}).on("blur.mask",d).on("keydown.mask",t).on("keypress.mask",n).on("input.mask paste.mask",function(){if(o.prop("readonly")){return}setTimeout(function(){var e=b(true);o.caret(e);c()},0)});if(E&&C){o.off("input.mask").on("input.mask",e)}b()})}})});